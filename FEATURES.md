# Idensyra 功能總覽

## 📋 目錄
- [核心功能](#核心功能)
- [虛擬工作區](#虛擬工作區)
- [編輯器功能](#編輯器功能)
- [主題系統](#主題系統)
- [使用者介面](#使用者介面)
- [快捷鍵](#快捷鍵)
- [檔案操作](#檔案操作)
- [執行與輸出](#執行與輸出)

---

## 核心功能

### Go 程式碼執行引擎
- ✅ 基於 Yaegi 直譯器的即時執行
- ✅ 支援 Insyra 數據分析函式庫
- ✅ 完整的 Go 標準庫支援
- ✅ 錯誤訊息即時顯示

### Live Run（即時執行）
- ✅ 程式碼變更時自動執行
- ✅ 防抖機制避免頻繁執行
- ✅ 可隨時啟用/停用
- ✅ 狀態通知回饋

---

## 虛擬工作區

### 臨時工作區管理
- ✅ **自動建立**：程式啟動時自動建立臨時工作區
- ✅ **系統暫存**：使用系統臨時資料夾儲存檔案
- ✅ **自動清理**：程式關閉時自動刪除所有暫存檔案
- ✅ **未儲存警告**：關閉前檢查並警告未匯出的變更

### 多檔案支援
- ✅ **建立新檔案**
  - 點擊側邊欄 + 按鈕
  - 輸入自訂檔案名稱
  - 自動加上 .go 副檔名
  - 使用預設範本初始化
- ✅ **檔案切換**
  - 點擊側邊欄中的檔案名稱
  - 活動檔案以藍色高亮顯示
  - 自動載入檔案內容
- ✅ **檔案刪除**
  - 滑鼠懸停顯示刪除按鈕
  - 確認對話框防止誤刪
  - 無法刪除最後一個檔案
- ✅ **修改狀態追蹤**
  - 黃色 ● 指示器顯示未儲存變更
  - 檔案層級和工作區層級狀態
  - 即時更新顯示

### 檔案樹側邊欄
- ✅ **視覺化檔案管理**
  - 📄 檔案圖示（綠色）
  - 檔案名稱顯示
  - 修改狀態指示器
  - 活動檔案高亮
- ✅ **快速操作**
  - 點擊切換檔案
  - 懸停顯示刪除按鈕
  - 工具列按鈕（新增、匯出）

### 自動儲存
- ✅ **即時儲存**：編輯後 2 秒自動儲存到暫存區
- ✅ **手動儲存**：`Ctrl/Cmd + S` 或 Save 按鈕
- ✅ **防抖機制**：避免頻繁寫入檔案
- ✅ **狀態回饋**：儲存後更新修改指示器

### 工作區匯出
- ✅ **一鍵匯出**：點擊 ⬇ 按鈕匯出整個工作區
- ✅ **預設位置**：`Documents/idensyra-exports/`
- ✅ **時間戳記資料夾**：`idensyra-export-YYYYMMDD-HHMMSS`
- ✅ **完整檔案結構**：包含 `package main` 標頭
- ✅ **狀態更新**：匯出後標記為已儲存

### 關閉保護
- ✅ **自動檢查**：關閉前檢查未匯出變更
- ✅ **警告對話框**：瀏覽器標準 beforeunload 警告
- ✅ **防止資料遺失**：給予儲存機會
- ✅ **強制清理**：確認離開後清除暫存檔案

### 預設範本
每個新檔案包含：
```go
import (
    "fmt"
    "log"
    "github.com/HazelnutParadise/insyra/isr"
    "github.com/HazelnutParadise/insyra"
    "github.com/HazelnutParadise/insyra/datafetch"
    "github.com/HazelnutParadise/insyra/stats"
    "github.com/HazelnutParadise/insyra/parallel"
    "github.com/HazelnutParadise/insyra/plot"
    "github.com/HazelnutParadise/insyra/gplot"
    "github.com/HazelnutParadise/insyra/lpgen"
    "github.com/HazelnutParadise/insyra/csvxl"
    "github.com/HazelnutParadise/insyra/py"
)

func main() {
    fmt.Println("Hello, World!")
    log.Println("this is a log message")
    dl := insyra.NewDataList(1, 2, 3)
    fmt.Println("This is your data list:", dl.Data())
}
```

---

## 編輯器功能

### Monaco Editor 整合
- ✅ 完整的 Monaco Editor 支援（本地化，無 CDN）
- ✅ Go 語言語法高亮
- ✅ 智慧自動完成
- ✅ 括號自動配對
- ✅ 程式碼摺疊
- ✅ 行號顯示
- ✅ 多游標編輯

### 自動完成功能
- ✅ Go 語言關鍵字
- ✅ 標準庫函式（fmt, strings, time, math 等）
- ✅ Insyra 函式庫函式
- ✅ 常用型別建議
- ✅ 觸發快捷鍵：`Ctrl + Space`

### 編輯操作
- ✅ **復原（Undo）**：`Ctrl + Z` / `Cmd + Z`
- ✅ **重做（Redo）**：`Ctrl + Shift + Z` / `Ctrl + Y` / `Cmd + Shift + Z` / `Cmd + Y`
- ✅ 多步復原/重做支援
- ✅ 選取、剪下、複製、貼上
- ✅ 尋找與取代
- ✅ 多行編輯

### 編輯器視圖選項
- ✅ **Minimap（程式碼縮略圖）**
  - 可開啟/關閉
  - 預設關閉
  - 設定持久化
  - 工具列按鈕控制
- ✅ **自動換行**
  - 可選擇換行或水平捲動
  - 預設關閉（顯示水平捲軸）
  - 設定持久化
  - 工具列按鈕控制
- ✅ **字體大小調整**
  - 範圍：8-32px
  - +/- 按鈕控制
  - 即時生效
  - 設定持久化

---

## 主題系統

### 跟隨系統主題
- ✅ **自動偵測**：啟動時偵測作業系統主題
- ✅ **Windows 支援**：跟隨「設定 > 個人化 > 色彩」
- ✅ **macOS 支援**：跟隨「系統偏好設定 > 一般 > 外觀」
- ✅ **即時切換**：系統主題改變時可手動切換

### 主題一致性
- ✅ **Monaco 編輯器**：與程式主題完全一致
- ✅ **不預設深色**：依系統或使用者選擇
- ✅ **標題顏色**：隨主題改變
  - 深色主題：青綠色 (#4ec9b0)
  - 淺色主題：藍色 (#007acc)

### 主題持久化
- ✅ 手動切換的主題會儲存
- ✅ 重新啟動時恢復上次選擇
- ✅ 未設定時使用系統主題

### 支援的主題
- ✅ **深色主題**
  - Monaco: vs-dark
  - 深色背景、淺色文字
  - ANSI 顏色優化
- ✅ **淺色主題**
  - Monaco: vs-light
  - 淺色背景、深色文字
  - ANSI 顏色優化（WCAG AA 對比度）

---

## 使用者介面

### 工具列
**標題列右側按鈕（由左至右）：**
1. ✅ **Live Run 核取方塊** - 啟用/停用自動執行
2. ✅ **Minimap 按鈕** (📍) - 切換程式碼縮略圖
3. ✅ **自動換行按鈕** (↔️) - 切換換行模式
4. ✅ **主題切換按鈕** (🎨) - 切換深色/淺色主題
5. ✅ **GitHub 按鈕** - 開啟專案 GitHub 頁面
6. ✅ **HazelnutParadise 按鈕** (🔗) - 開啟相關網站

### 視覺回饋
- ✅ **啟用狀態指示**：啟用的功能按鈕顯示藍色高亮
- ✅ **通知訊息**：操作完成後顯示通知
- ✅ **智慧通知管理**：新通知自動隱藏舊通知，避免堆疊
- ✅ **動畫效果**：滑入/滑出動畫
- ✅ **自動消失**：3 秒後自動隱藏

### 面板佈局
- ✅ **可調整分割**：拖曳中間分隔線調整編輯器與輸出區大小
- ✅ **最小/最大限制**：20%-80% 範圍
- ✅ **比例持久化**：重啟後恢復分割比例
- ✅ **響應式設計**：自動適應視窗大小

### 版本資訊
- ✅ 顯示 Idensyra 版本
- ✅ 顯示 Insyra 函式庫版本
- ✅ 格式：`v{idensyra} with Insyra v{insyra}`

---

## 快捷鍵

### 程式碼編輯
| 功能 | Windows/Linux | macOS |
|------|--------------|-------|
| 執行程式碼 | `Ctrl + Enter` | `Cmd + Enter` |
| 儲存檔案 | `Ctrl + S` | `Cmd + S` |
| 復原 | `Ctrl + Z` | `Cmd + Z` |
| 重做 | `Ctrl + Shift + Z` 或 `Ctrl + Y` | `Cmd + Shift + Z` 或 `Cmd + Y` |
| 自動完成 | `Ctrl + Space` | `Ctrl + Space` |

### Monaco 編輯器內建快捷鍵
- ✅ `Ctrl/Cmd + F` - 尋找
- ✅ `Ctrl/Cmd + H` - 取代
- ✅ `Ctrl/Cmd + D` - 選取下一個相同項目
- ✅ `Ctrl/Cmd + /` - 切換註解
- ✅ `Alt + Up/Down` - 移動行
- ✅ `Shift + Alt + Up/Down` - 複製行
- ✅ `Ctrl/Cmd + Shift + K` - 刪除行

---

## 檔案操作

### 工作區檔案
- ✅ **建立新檔案**
  - 按鈕：+ (側邊欄)
  - 輸入自訂檔案名稱
  - 自動使用預設範本
- ✅ **儲存檔案**
  - 自動儲存：編輯後 2 秒
  - 手動儲存：Save 按鈕或 `Ctrl/Cmd + S`
  - 儲存到暫存工作區
- ✅ **刪除檔案**
  - 滑鼠懸停顯示 ✕ 按鈕
  - 確認對話框
  - 無法刪除最後一個檔案
- ✅ **匯出工作區**
  - 按鈕：⬇ (側邊欄)
  - 匯出到 Documents/idensyra-exports/
  - 包含所有檔案

### 外部檔案載入
- ✅ **載入 .go 檔案**
  - 按鈕：Load（編輯器區）
  - 檔案對話框選擇
  - 載入到當前活動檔案
  - 成功通知

### 輸出結果
- ✅ **複製輸出**
  - 按鈕：Copy
  - 複製到系統剪貼簿
  - 成功通知
- ✅ **儲存輸出**
  - 按鈕：Save（輸出區）
  - 儲存為文字檔
  - 檔案對話框選擇位置

---

## 執行與輸出

### 程式碼執行
- ✅ **手動執行**：點擊 "Run" 按鈕或 `Ctrl/Cmd + Enter`
- ✅ **自動執行**：啟用 Live Run 後自動執行
- ✅ **執行狀態**：執行中按鈕顯示 "Running..."
- ✅ **錯誤處理**：顯示編譯或執行錯誤

### 輸出顯示
- ✅ **ANSI 顏色支援**
  - 前景色（8 色 + 16 色）
  - 背景色（8 色 + 16 色）
  - 樣式（粗體、斜體、底線）
- ✅ **主題適配**
  - 深色主題顏色配置
  - 淺色主題顏色配置（WCAG AA 對比度）
- ✅ **字體大小調整**：8-32px
- ✅ **純文字顯示**：保留原始格式

### Insyra 彩色輸出
- ✅ 支援 `insyra.Red()`, `insyra.Green()`, `insyra.Blue()` 等彩色函式
- ✅ 顏色在深色/淺色主題下都清晰可讀
- ✅ 支援複雜的 ANSI 色碼組合

---

## 設定持久化

### 自動儲存的設定
所有設定都儲存在瀏覽器 localStorage：

| 設定項目 | 儲存鍵 | 預設值 |
|---------|--------|--------|
| 主題選擇 | `theme` | 系統主題 |
| Minimap 狀態 | `minimapEnabled` | `false` |
| 自動換行狀態 | `wordWrapEnabled` | `false` |
| 編輯器字體 | （動態） | 14px |
| 輸出字體 | （動態） | 13px |
| 面板分割比例 | （動態） | 50/50 |

**注意：** 工作區檔案本身儲存在系統暫存資料夾，不是 localStorage</text>

<old_text line=280>
### 適合場景
- ✅ 學習 Go 語言
- ✅ 快速測試程式碼片段
- ✅ 使用 Insyra 進行數據分析
- ✅ 演示和教學
- ✅ 原型開發

### 重啟恢復
- ✅ 所有設定在程式重新啟動後自動恢復
- ✅ 提供一致的使用者體驗
- ✅ 無需手動重新設定

---

## 技術特點

### 完全本地化
- ✅ **Monaco Editor**：本地打包（無 CDN）
- ✅ **Bootstrap**：本地打包（無 CDN）
- ✅ **Font Awesome**：本地打包（無 CDN）
- ✅ **離線可用**：無需網路連線

### 相依套件版本
- Monaco Editor: v0.55.1
- Bootstrap: v5.3.8
- Font Awesome: v7.1.0
- Wails: v2.11.0
- Insyra: v0.2.10
- Yaegi: v0.16.1

### 跨平台支援
- ✅ **Windows**：WebView2
- ✅ **macOS**：WebKit
- ✅ **Linux**：WebKitGTK（需安裝）

### 效能優化
- ✅ 防抖機制減少重複執行
- ✅ Monaco 自動佈局
- ✅ 高效的 ANSI 轉換
- ✅ 最小化不必要的 DOM 操作

---

## 使用建議

### 適合場景
- ✅ 學習 Go 語言
- ✅ 快速測試程式碼片段
- ✅ 使用 Insyra 進行數據分析
- ✅ 演示和教學
- ✅ 原型開發

### 最佳實踐
1. **長檔案**：開啟 Minimap 方便導航
2. **長行程式碼**：開啟自動換行避免水平捲動
3. **實驗性程式碼**：使用 Live Run 即時查看結果
4. **正式開發**：關閉 Live Run 手動執行
5. **善用快捷鍵**：提升編輯效率
6. **多檔案專案**：善用工作區建立多個 .go 檔案
7. **定期匯出**：重要工作記得定期匯出工作區

### 提示與技巧
- 💡 按 `Ctrl + Space` 查看可用的函式建議
- 💡 使用 `Ctrl + Z` / `Ctrl + Y` 快速復原/重做
- 💡 拖曳分隔線調整編輯器和輸出區大小
- 💡 主題會跟隨系統，也可手動切換
- 💡 所有設定都會自動儲存，無需擔心遺失
- 💡 工作區檔案會自動儲存，但記得匯出以永久保存
- 💡 檔案名稱旁的 ● 表示有未儲存變更
- 💡 可以建立多個 .go 檔案來組織程式碼</text>

<old_text line=303>
### ✅ 已實現
- 所有核心功能
- 所有編輯器功能
- 完整的主題系統
- 復原/重做支援
- Minimap 與自動換行控制
- 完整的設定持久化
- ANSI 顏色支援
- 智慧通知管理

---

## 功能狀態

### ✅ 已實現
- 所有核心功能
- 所有編輯器功能
- 完整的主題系統
- 復原/重做支援
- Minimap 與自動換行控制
- 完整的設定持久化
- ANSI 顏色支援
- 智慧通知管理

### 🔮 未來可能改進
- 更多編輯器主題選擇
- 自訂鍵盤快捷鍵
- 設定匯出/匯入
- 程式碼片段管理
- 檔案重新命名功能
- 整合式偵錯工具
- 套件管理介面
- 自訂匯出位置
- 工作區匯入/開啟功能
- ZIP 格式匯出選項</text>


---

**版本：** Idensyra with Wails v2.11.0  
**更新日期：** 2025-12-31  
**文件版本：** 1.0
